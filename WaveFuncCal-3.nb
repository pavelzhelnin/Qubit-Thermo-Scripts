(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13850,        394]
NotebookOptionsPosition[     12864,        370]
NotebookOutlinePosition[     13261,        386]
CellTagsIndexPosition[     13218,        383]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"\[Epsilon]_", ",", "\[Tau]_"}], "]"}], " ", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Epsilon]", "*", "\[Tau]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], "*", "\[Tau]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eigvals", ",", "eigvecs"}], "}"}], "=", 
     RowBox[{"Eigensystem", "[", 
      RowBox[{"h", "[", 
       RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"\[Epsilon]_", ",", "\[Tau]_"}], "]"}], "=", " ", 
     RowBox[{"Transpose", "[", "eigvecs", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"\[Epsilon]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"v", "[", 
        RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "]"}], ".", 
      RowBox[{"h", "[", 
       RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], ".", 
      RowBox[{"v", "[", 
       RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"\[Epsilon]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "I"}], "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"v", "[", 
         RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "]"}], ".", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], ",", "\[Tau]"}], 
        "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"d", "[", 
            RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Tau]", "->", "x"}], " ", ",", 
             RowBox[{"\[Epsilon]", "->", "0.3018"}]}], "}"}]}], "]"}], "//", 
         "Simplify"}], ",", "10"}], "]"}], "/", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Tau]", "->", "x"}], ",", 
             RowBox[{"\[Epsilon]", "->", "0.3018"}]}], "}"}]}], " ", "]"}], "//",
          "Simplify"}], ",", "10"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Qs", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"q", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "10"}], "+", "0.0001"}], ",", "10.0001", ",", "1"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"\[Epsilon]_", ",", "\[Tau]_"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}], "+", 
      RowBox[{"c", "[", 
       RowBox[{"\[Epsilon]", ",", "\[Tau]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "Qs", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "i", "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9494869565203342`*^9, 3.949487294049905*^9}, {
  3.949487412085484*^9, 3.949487461543584*^9}, {3.949487530258526*^9, 
  3.949487539460187*^9}, {3.949487747759603*^9, 3.949487821409789*^9}, {
  3.949487855684224*^9, 3.949487910919372*^9}, {3.949488113903715*^9, 
  3.949488262310298*^9}, {3.949488311063088*^9, 3.949488352960973*^9}, {
  3.94948861278437*^9, 3.9494886233838587`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3e18dd21-f667-4ba9-8b7f-eb4acb4702d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.9999`"}], ",", "0.8714705090172521`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.9999`"}], ",", "0.8809404251598905`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.9999`"}], ",", "0.8938031435816381`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.9999`"}], ",", "0.9118178483599895`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.9999`"}], ",", "0.937967262660445`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.9999`"}], ",", "0.977510824899998`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.9999000000000002`"}], ",", "1.0399762228040312`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9999000000000002`"}], ",", "1.142209710379917`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9999000000000002`"}], ",", "1.3075755126312707`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9999000000000002`"}], ",", "1.529100907786915`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0.00009999999999976694`", ",", "1.656726307304784`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1.0000999999999998`", ",", "1.5290577169172925`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.0000999999999998`", ",", "1.3075351148897245`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.0000999999999998`", ",", "1.1421837190976258`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.0001`", ",", "1.0399604677350283`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.0001`", ",", "0.9775010416725595`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.0001`", ",", "0.9379609226864172`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.0001`", ",", "0.9118135600621069`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.0001`", ",", "0.8938001301308052`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.0001`", ",", "0.880938236752392`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10.0001`", ",", "0.8714688744832438`"}], "}"}]}], "}"}]], "Print",\

 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.9494886281576138`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"2767756a-8a80-4814-9aec-cd9cc219dd8b"],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.949488628167041*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"9a03ad76-68f0-405c-bcf6-e8eadb8aa4fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.9999`"}], ",", "0.004442402243282323`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.9999`"}], ",", "0.005402346230578558`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.9999`"}], ",", "0.006698776414215547`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.9999`"}], ",", "0.008502203506482297`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.9999`"}], ",", "0.01110077502655626`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.9999`"}], ",", "0.015008144923246727`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.9999000000000002`"}], ",", "0.021208006709836226`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9999000000000002`"}], ",", "0.031818616944032034`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9999000000000002`"}], ",", "0.05264524231832105`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9999000000000002`"}], ",", "0.11143334910912411`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00009999999999976694`", ",", "1106.6257499169362`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1.0000999999999998`", ",", "0.11141043068023188`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"2.0000999999999998`", ",", "0.052639123624932616`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.0000999999999998`", ",", "0.031815788027490036`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.0001`", ",", "0.02120642808859508`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.0001`", ",", "0.015007179038245272`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.0001`", ",", "0.011100147054245484`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.0001`", ",", "0.008501775688382434`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.0001`", ",", "0.006698473610293375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.0001`", ",", "0.005402124958113923`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10.0001`", ",", "0.004442236120871199`"}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.949488628283629*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"03c9728d-18e5-4676-9dd6-c38d1d0b1aab"],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.9494886282928143`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"5128a6f8-f258-43ec-8612-a182085f9e94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.9999`"}], ",", "0.00008347247661719825`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.9999`"}], ",", "0.0001220500943873613`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.9999`"}], ",", "0.00018471577376139495`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.9999`"}], ",", "0.0002908421912910866`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.9999`"}], ",", "0.00047890137111919354`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.9999`"}], ",", "0.0008277560276571083`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.9999000000000002`"}], ",", "0.0014994558197065032`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9999000000000002`"}], ",", "0.00280208569584614`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9999000000000002`"}], ",", "0.005197803880761179`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9999000000000002`"}], ",", "0.011211733436569395`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00009999999999976694`", ",", "8.968378328397302`*^-15"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0000999999999998`", ",", "0.006308049948011579`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.0000999999999998`", ",", "0.005208497078468279`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.0000999999999998`", ",", "0.0028884984010547525`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4.0001`", ",", "0.001539351317413974`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.0001`", ",", "0.0008447649315953574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.0001`", ",", "0.00048647248661217514`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.0001`", ",", "0.0002944376432701426`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.0001`", ",", "0.00018653664167807117`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.0001`", ",", "0.00012302757962591012`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10.0001`", ",", "0.00008402481190271842`"}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.949488629698312*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"fd1d547c-2ea3-49e6-bc97-abee5fd667a8"],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.9494882091958647`*^9, 3.949488263674275*^9, {3.949488311556189*^9, 
   3.949488353409299*^9}, 3.949488629706903*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"f4d1a5f7-2695-4414-85c5-7701e03fcb39"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 690},
WindowMargins->{{Automatic, -1785}, {-108, Automatic}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b8cf8b3c-69b4-4c40-8019-64a83d6bdb93"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4163, 112, 262, "Input",ExpressionUUID->"3e18dd21-f667-4ba9-8b7f-eb4acb4702d2"],
Cell[CellGroupData[{
Cell[4768, 138, 2371, 66, 101, "Print",ExpressionUUID->"2767756a-8a80-4814-9aec-cd9cc219dd8b"],
Cell[7142, 206, 272, 6, 24, "Print",ExpressionUUID->"9a03ad76-68f0-405c-bcf6-e8eadb8aa4fc"],
Cell[7417, 214, 2417, 67, 120, "Print",ExpressionUUID->"03c9728d-18e5-4676-9dd6-c38d1d0b1aab"],
Cell[9837, 283, 274, 6, 24, "Print",ExpressionUUID->"5128a6f8-f258-43ec-8612-a182085f9e94"],
Cell[10114, 291, 2447, 67, 128, "Print",ExpressionUUID->"fd1d547c-2ea3-49e6-bc97-abee5fd667a8"],
Cell[12564, 360, 272, 6, 24, "Print",ExpressionUUID->"f4d1a5f7-2695-4414-85c5-7701e03fcb39"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

